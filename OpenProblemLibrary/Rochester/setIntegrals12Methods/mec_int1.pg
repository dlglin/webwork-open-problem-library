## DESCRIPTION
## Evaluate an indefinite integral using trigonometric identities and
## integration by parts.
## ENDDESCRIPTION

## Tagged by tda2d

## DBsubject(Calculus - single variable)
## DBchapter(Techniques of integration)
## DBsection(Mixed techniques)
## Institution(ASU)
## Level(3)
## TitleText1('Calculus: Early Transcendentals')
## AuthorText1('Stewart')
## EditionText1('6')
## Section1('7.1')
## Problem1('5 8 20')
## KEYWORDS('indefinite' 'integral','integrals', 'integration by parts','substitution')

DOCUMENT();    # This should be the first executable line in the problem.

loadMacros('PGstandard.pl', 'PGML.pl', 'PGcourse.pl');

$c       = random(2, 9, 1);
$g       = random(0, 1, 1);
$twoc    = 2 * $c;
$fourc   = 4 * $c;
$fourc2  = 4 * $c**2;
$eightc2 = 8 * $c**2;

if ($g == 0) {
    $trig = "sin";
    $pm   = "-";
    $ans =
        Compute("1/4*x^2 - 1/$fourc*x*sin($twoc*x) - 1/$eightc2*cos($twoc*x)");
} else {
    $trig = "cos";
    $pm   = "+";
    $ans =
        Compute("1/4*x^2 + 1/$fourc*x*sin($twoc*x) + 1/$eightc2*cos($twoc*x)");
}
$f = Formula("x*$trig^2($c*x)");

BEGIN_PGML
Evaluate the indefinite integral.

[`` \int [$f]\; dx =``][_]{$ans->cmp(upToConstant=>1)}[``+C``]
END_PGML

$T2 = Formula("$trig^2($c*x)");

BEGIN_PGML_SOLUTION
First use the identity [`[$T2]=\frac{1}{2}\left(1[$pm]\cos([$twoc]x)\right)`] to rewrite the integral:

[`` \int [$f]\; dx =\int \frac{1}{2}x\left(1[$pm]\cos([$twoc]x)\right)\; dx = \frac{1}{2}\left(\int x\;dx[$pm]\int x\cos([$twoc]x)\;dx\right)``]

We will evaluate the second integral using integration by parts.
    [``\int x\cos([$twoc]x)\;dx``]  
        [`\boxed{\begin{aligned} u &= x &  dv &= \cos([$twoc]x)\;dx\\
        du &= dx &  v &= \frac{1}{[$twoc]}\sin([$twoc]x)\end{aligned}}`]  
    [``=\frac{1}{[$twoc]}x\sin([$twoc]x)-\int\frac{1}{[$twoc]}\sin([$twoc]x)\;dx``]  
    [``=\frac{1}{[$twoc]}x\sin([$twoc]x)+\frac{1}{[$fourc2]}\cos([$twoc]x)+C``]

Returning to the original integral:

[``\begin{align*} \int [$f]\; dx &= \frac{1}{2}\left(\frac{1}{2}x^2[$pm]\left(\frac{1}{[$twoc]}x\sin([$twoc]x)+\frac{1}{[$fourc2]}\cos([$twoc]x)\right)\right)+C\\
&= [$ans->{correct_ans_latex_string}]\end{align*}``]
END_PGML_SOLUTION

ENDDOCUMENT();    # This should be the last executable line in the problem.
